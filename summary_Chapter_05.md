# Chapter 5. 프로그램 내에서 코드로 카프카 관리하기
- 사용자 입력에 기반해서 새 토픽 작성하는 경우는 흔하다
- `Apache Kafka` 버전 0.11부터 프로그램적인 관리 기능 API 제공 목적으로 `AdminClient` 추가
    - 토픽 목록 조회, 생성, 삭제, 클러스터 상세 정보 확인, ACL 관리, 설정 변경 등의 기능
## 5.1 AdminClient 개요
### 5.1.1 비동기적이고 최종적 일관성 갖는 API
**`AdminClient`를 이해할 때 가장 중요한 것은 비동기적 (Asynchronous) 으로 작동한다는 것**
- 각 메서드는 요청을 클러스터 컨트롤러로 전송한 뒤 바로 1개 이상의 `Future` 객체 리턴
	> `AdminClient`에게 "토픽 A를 만들어줘!"라고 명령하면, `AdminClient`는 그 명령을 카프카에 전달하자마자 "응, 알겠어. 만드는 중이야!"라는 의미의 `접수증(Future 객체)`만 바로 돌려주고, 토픽이 실제로 다 만들어질 때까지 기다려주지 않는다. 
- 덕분에 애플리케이션은 토픽이 생성되는 동안 멈추지 않고 다른 중요한 작업을 계속 처리할 수 있다. 
	- 이는 시스템 전체의 효율과 응답성을 크게 높여준다.
- `Future` 객체는 아래의 역할을 수행하는 메서드 갖고 있다.
	- 비동기 작업 결과 확인
	- 비동기 작업 결과 취소
	- 비동기 작업 완료될 때까지 대기
	- 비동기 작업 완료되었을 때 실행할 함수 지정
- `AdminClient`는 `Future` 객체를 `Result` 객체 안에 감싸는데, `Result` 객체는 작업이 끝날때까지 대기하거나 작업 결과에 대해 일반적으로 뒤이어 쓰이는 작업 수행하는 헬퍼 메서드 갖고 있다.
**최종적 일관성 (Eventual Consistency)**
- `AdminClient`를 사용해 **토픽 생성**을 요청하는 것은 **비동기** 작업
- 이 요청은 클러스터의 리더인 **`클러스터 컨트롤러`**에게 전달
- `컨트롤러`는 요청을 받자마자 "알겠다"는 의미의 **`Future` 객체**를 돌려주고, 실제 작업에 착수
- `컨트롤러`는 클러스터의 상태 정보(메타데이터)를 변경하고, 이 변경 사항을 다른 모든 **`브로커`**에게 전파
- 이 정보가 전파되는 데 걸리는 아주 짧은 시간 동안 클러스터는 **일시적으로 불일치 상태**
- 전파가 완료되면 클러스터 전체가 새로운 토픽의 존재를 인지하게 되며, **최종적 일관성** 달성
	- 최종적으로 모든 브로커는 모든 토픽에 대해 알게 될 것이지만, 정확히 언제가 될 지에 대해서는 아무런 보장도 할 수 없다

